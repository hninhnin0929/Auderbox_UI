<ion-content>
  <div class="myOuterContainer">
      
      <div class="tab-content" id="pills-tabContent">
          <div id="dlist" role="tabpanel">
              <div class="card mb-1">
                  <div class="card-header bg-transparent advance-form"> {{spinner? 'Loading shop list':'Advance'}}
                        <i *ngIf="!spinner" (click)="advanceSearch(searchtab? false: true);"
                            [class]="searchtab? 'fa fa-chevron-circle-up':'fa fa-chevron-circle-down'"
                            aria-hidden="true">
                        </i>
                        <div class="spinner-border text-primary" role="status" id="spinner-advsearch" *ngIf="spinner">
                            <span class="sr-only"></span>
                        </div>
                  </div>
                  
                  <div class="card-body" *ngIf="searchtab" id="advance-card">
                      <div class="row">
                        <!-- <div class="row"> -->
                            <div class="col">

                                <div class="form-group row">
                                  <label for="fromdate" class="col-sm-5 col-form-label col-form-label-sm">Created From</label>
                                  <div class="col-sm px-0">
                                    <div class="input-group input-group-sm">
                                      <input required [(ngModel)]="searchObj.fromdate" class="form-control" style="max-width: 170px;"
                                        matInput [matDatepicker]="picker1" placeholder="Select Date" name="fromdate" readonly>
                                      <div class="input-group-append date-form">
                                        <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="picker1.open()"></i>
                                        <mat-datepicker #picker1 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                                        </mat-datepicker>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                
                                <div class="form-group row">
                                  <label for="modifiedfrom" class="col-sm-5 col-form-label col-form-label-sm">Modified From</label>
                                  <div class="col-sm px-0">
                                    <div class="input-group input-group-sm">
                                      <input required [(ngModel)]="searchObj.modifiedfrom" class="form-control" style="max-width: 170px;"
                                        matInput [matDatepicker]="picker3" placeholder="Select Date" name="modifiedfrom" readonly>
                                      <div class="input-group-append date-form">
                                        <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="picker3.open()"></i>
                                        <mat-datepicker #picker3 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                                        </mat-datepicker>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                
                                <div class="form-group row">
                                  <label for="shop-name" class="col-sm-5 col-form-label col-form-label-sm">Shop Name</label>
                                  <div class="col-sm px-0">
                                    <input type="text" matInput id="shop-name" class=" form-control form-control-sm"
                                      style="max-width: 200px;" [(ngModel)]="searchObj.shopName" 
                                      >
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label for="shop-phno" class="col-sm-5 col-form-label col-form-label-sm">Phone Number</label>
                                  <div class="col-sm  px-0">
                                    <input type="text" id="shop-phno" class="form-control form-control-sm" style="max-width: 200px;"
                                      [(ngModel)]="searchObj.phno">
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label for="cri-state" class="col-sm-5 col-form-label col-form-label-sm">State</label>
                                  <div class="col-sm px-0">
                                    <select [(ngModel)]="searchObj.n20" class="custom-select custom-select-sm" style="max-width: 200px;"
                                      name="cri-state" id="cri-state" (change)="criStateChange()">
                                      <option value="">-</option>
                                      <option value="{{sl.syskey}}"  *ngFor="let sl of criStateList">
                                        {{sl.t2}}
                                      </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label for="cri-town" class="col-sm-5 col-form-label col-form-label-sm">Town</label>
                                  <div class="col-sm px-0">
                                    <select [(ngModel)]="searchObj.n23" class="custom-select custom-select-sm" style="max-width: 200px;"
                                      name="cri-town" id="cri-town" (change)="criTownChange()" [disabled]="searchObj.n22 == ''">
                                      <option value="">-</option>
                                      <option value="{{tl.syskey}}"  *ngFor="let tl of criTownList">
                                        {{tl.t2}}
                                      </option>
                                    </select>
                                  </div>
                                </div>
                              </div>
                              <div class="col">
                
                                <div class="form-group row">
                                  <label for="todate" class="col-sm-5 col-form-label col-form-label-sm">Created To</label>
                                  <div class="col-sm px-0">
                                    <div class="input-group input-group-sm">
                                      <input required [(ngModel)]="searchObj.todate" [min]="searchObj.fromdate" class="form-control"
                                        style="max-width: 170px;" matInput [matDatepicker]="picker2" placeholder="Select Date"
                                        name="todate" readonly>
                                      <div class="input-group-append date-form">
                                        <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="picker2.open()"></i>
                                        <mat-datepicker #picker2 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                                        </mat-datepicker>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                
                                <div class="form-group row">
                                  <label for="modifiedto" class="col-sm-5 col-form-label col-form-label-sm">Modified To</label>
                                  <div class="col-sm px-0">
                                    <div class="input-group input-group-sm">
                                      <input required [(ngModel)]="searchObj.modifiedto" [min]="searchObj.modifiedfrom" class="form-control"
                                        style="max-width: 170px;" matInput [matDatepicker]="picker4" placeholder="Select Date"
                                        name="todate" readonly>
                                      <div class="input-group-append date-form">
                                        <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="picker4.open()"></i>
                                        <mat-datepicker #picker4 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                                        </mat-datepicker>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                                <div class="form-group row">
                                  <label for="shop-name" class="col-sm-5 col-form-label col-form-label-sm">Shop Code</label>
                                  <div class="col-sm px-0">
                                    <input type="text" matInput id="shop-code" class=" form-control form-control-sm"
                                      style="max-width: 200px;" [(ngModel)]="searchObj.shopCode" 
                                      >
                                  </div>
                                </div>
                
                                <!-- <div class="form-group row">
                                  <label for="shop-oname" class="col-sm-5 col-form-label col-form-label-sm">Shop Owner name</label>
                                  <div class="col-sm  px-0">
                                    <input type="text" id="shop-oname" class="form-control form-control-sm " style="max-width: 200px;"
                                      [(ngModel)]="searchObj.personName">
                                  </div>
                                </div> -->
                                <div class="form-group row">
                                  <label for="shop-email" class="col-sm-5 col-form-label col-form-label-sm">Status</label>
                                  <div class="col-sm  px-0">
                                    <select [(ngModel)]="searchObj.activeStatus" class="custom-select custom-select-sm"
                                      style="max-width: 200px;" name="cri-ordering" id="cri-ordering">
                                      <option value="-1">-</option>
                                      <option value="0">Active</option>
                                      <option value="1" >Inactive</option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label for="cri-district" class="col-sm-5 col-form-label col-form-label-sm">District</label>
                                  <div class="col-sm px-0">
                                    <select [(ngModel)]="searchObj.n21" class="custom-select custom-select-sm" style="max-width: 200px;"
                                      name="cri-district" id="cri-district" (change)="criDistrictChange()"
                                      [disabled]="searchObj.n20 == ''">
                                      <option value="">-</option>
                                      <option value="{{dl.syskey}}"  *ngFor="let dl of criDistrictList">
                                        {{dl.t2}}
                                      </option>
                                    </select>
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label for="cri-ward" class="col-sm-5 col-form-label col-form-label-sm">Ward</label>
                                  <div class="col-sm px-0">
                                    <select [(ngModel)]="searchObj.n24" class="custom-select custom-select-sm" style="max-width: 200px;"
                                      name="cri-ward" id="cri-ward" [disabled]="searchObj.n23 == ''">
                                      <option value="">-</option>
                                      <option value="{{wl.syskey}}"  *ngFor="let wl of criWardList">
                                        {{wl.t2}}
                                      </option>
                                    </select>
                                  </div>
                                </div>
                              </div>
                
                            <div class="col">
                                <div class="form-group row">
                                  <label for="cri-dateoptions" class="col-sm-4 col-form-label col-form-label-sm">Date Options</label>
                                  <div class="col-sm px-0">
                                    <select [(ngModel)]="searchObj.dateOptions" class="custom-select custom-select-sm"
                                      name="cri-dateoptions" id="cri-dateoptions" (change)="dateOptionsChange()"
                                      style="max-width: 200px;">
                                        <option value="0" selected>-</option>
                                        <option value="today">
                                          Today
                                        </option>
                                        <option value="yesterday">
                                          Yesterday
                                        </option>
                                        <option value="this_week">
                                          This Week
                                        </option>
                                        <option value="last_week">
                                          Last Week
                                        </option>
                                        <option value="this_month">
                                          This Month
                                        </option>
                                        <option value="last_month">
                                          Last Month
                                        </option>
                                    </select>
                
                                  </div>
                                </div>
                                <div class="form-group row">
                                  <label for="shop-email" class="col-sm-4 col-form-label col-form-label-sm">Address</label>
                                  <div class="col-sm  px-0">
                                    <textarea class="form-control form-control-sm" rows="3" 
                                      id="textarea-criteria" style="font-size: small; max-width: 200px;" 
                                      [(ngModel)]="searchObj.address">
                                    </textarea>
                                    
                                  </div>
                                </div>
                
                
                                <div class="form-group row">
                                  <label for="inactive" class="col-sm-4 col-form-label col-form-label-sm">Store Type</label>
                                  <div class="col-sm px-0">
                                    <mat-select class="form-control form-control-sm" [(ngModel)]="chooseStoreType" multiple style="max-width: 200px;">
                                      <mat-option [value]="" [disabled]="true">-</mat-option>
                                      <mat-option [value]="t.t1" *ngFor="let t of storeType; let i = index" [value]="t">
                                        {{t.t2}}
                                      </mat-option>
                                    </mat-select>
                                  </div>
                                </div>
                
                                <div class="form-group row">
                                  <label for="cri-township" class="col-sm-4 col-form-label col-form-label-sm">Township</label>
                                  <div class="col-sm px-0">
                                    <select [(ngModel)]="searchObj.n22" class="custom-select custom-select-sm" style="max-width: 200px;"
                                      name="cri-township" id="cri-township" (change)="criTownshipChange()"
                                      [disabled]="searchObj.n21 == ''">
                                      <option value="">-</option>
                                      <option value="{{tsl.syskey}}"  *ngFor="let tsl of criTownshipList">
                                        {{tsl.t2}}
                                      </option>
                                    </select>
                                  </div>
                                </div>

                                <div class="form-group row" [hidden]="!isUseSAP">
                                  <label for="cri-ward" class="col-sm-4 col-form-label col-form-label-sm">Distribution Channel</label>
                                  <div class="col-sm px-0">
                                    <mat-select class="form-control form-control-sm" id="dischaninv" name="dischaninv"  style="max-width: 200px;"
                                      [(ngModel)]="searchObj.disChanSyskey"  [ngModelOptions]="{standalone: true}" multiple>                       
                                      <mat-option [value]="-1" #triggerAllDisChanSelectOption (click)="toggleDisChanAllSelect()">
                                        Select All
                                      </mat-option>
                                      <mat-option [value]="dischan.syskey" *ngFor="let dischan of disChannelList; let i = index">
                                          {{dischan.desc}}
                                      </mat-option>
                                    </mat-select>
                                  </div>
                                </div>
                            </div> 
                      </div>
                      
                      <div class="row">
                        <div class="col">
                          <div class="d-flex justify-content-start">
                              <div class="btn-group" role="group" style="height: 35px;">
                                  <button (click)="search()" type="button" class="btn btn-primary"
                                      [disabled]="spinner">
                                      <i class="fa fa-search" aria-hidden="true"></i>
                                  </button>
                                  <button (click)="advanceSearchReset()" type="button" class="btn btn-primary">
                                      <i class="fa fa-refresh" aria-hidden="true"></i>
                                  </button>
                              </div>
                              <div class="d-flex justify-content-start">
                                  <div class="btn-group" style="height: 35px; margin-left: 10px;">
                                      <button (click)="print()" type="button" class="btn btn-primary">
                                          Export
                                      </button>
                                  </div>
                              </div>
                              <div class="d-flex justify-content-start">
                                <div class="btn-group" style="height: 35px; margin-left: 10px;">
                                    <button (click)="saveAll()" type="button" class="btn btn-primary" [disabled]="!saveBtn_Access">
                                        Save All
                                    </button>
                                </div>
                            </div>
                          </div>
                      </div>
                      </div>
                  </div>

              </div>

              <div class="d-flex justify-content" *ngIf="shoplist.length > 0">
                <pagination-controls class="my-pagination" 
                  (pageChange)="pageChanged($event)">
                </pagination-controls>
                <span
                  class="ml-2 text-muted align-middle form-control-sm">{{shoplist.length}}</span>
                  <div class="mr-3" style="position: absolute;right: 0;">
                    <mat-checkbox labelPosition='after' [(ngModel)]="searchObj.checkAll"
                    (change)="checkAllShops($event)" [disabled]="spinner">
                      Select All
                    </mat-checkbox>
                  </div>
              </div>  
              
              <!-- <pagination-controls class="my-pagination" (pageChange)="pageChanged($event)">
              </pagination-controls> -->
              <div class="table-responsive overflow-auto mt-1" >

                  <table class="table table-hover" style="font-size: 13px;">
                      <thead class="thead-dark">
                          <tr>
                              <th scope="col" class="sticky-top" style="width: 1%">#</th>
                              <th scope="col" class="sticky-top" style="width: 10%;">Shop Code</th>
                              <th scope="col" class="sticky-top" style="width: 10%;">Shop Name</th>
                              <th scope="col" class="sticky-top" style="width: 30%;">Shop Address</th>
                              <th scope="col" class="sticky-top" style="width: 15%;">
                                <mat-checkbox labelPosition='before' [(ngModel)]="checkPayTerm">
                                  Payment Term
                                </mat-checkbox>
                              </th>
                              <th scope="col" class="sticky-top" style="width: 10%;">
                                <mat-checkbox labelPosition='before' [(ngModel)]="checkCrdLimit">
                                  Credit Limit
                                </mat-checkbox>
                              </th>  
                              <th scope="col" class="sticky-top" style="width: 10%;"></th>                             
                          </tr>
                      </thead>
                      <tbody>
                          <tr *ngFor="let shop of shoplist | paginate: config;let i = index">
                                <th scope="row">{{i+1}}</th>
                                <td>
                                  <mat-checkbox labelPosition='after' [(ngModel)]="shop.isChangePayTerm"
                                  (change)="checkShop(shop)">
                                  {{shop.shopCode}}
                                  </mat-checkbox></td> 
                                <td>{{shop.shopName}}</td>
                                <td>{{shop.address}}</td>
                                <td>
                                  <div class="form-group row">
                                    <div class="col-sm"s>
                                      <select  [(ngModel)]="shop.n31" (change)="changePaymentTerm($event, i)" 
                                        class="custom-select custom-select-sm" name="ptermlst" id="sale_ptermlst"
                                        [disabled]="!shop.isChangePayTerm">
                                        <option [value]="pterm.syskey" *ngFor="let pterm of payTermList">
                                          {{pterm.desc}}
                                        </option>
                                      </select>
                                    </div>
                                  </div>                                  
                                </td>
                                <td>
                                    <div class="input-group input-group-sm searchbox"  style="min-width: 200px;">
                                          <input type="number" id="crd-limit" [disabled]="!shop.isChangePayTerm"  [(ngModel)]="shop.n15" class=" form-control form-control-sm"
                                          style="text-align: right;" (keyup.enter)="setCreditLimitAll(shop)"> 
                                    </div>            
                                </td>
                                <td>
                                  <div>
                                    <button class="btn btn-sm  " type="button" 
                                      style="border-color: #cacaca;border-left: none;background-color: green;color: white;width: 100%;"
                                      (click)="shop.check=true;save(shop);" id="btn-shop-name-search" [disabled]="!saveBtn_Access || !shop.isChangePayTerm">Save</button>
                                 </div>
                                </td>
                                
                          </tr>
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
  </div>
</ion-content>