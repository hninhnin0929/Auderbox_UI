<ion-content>
  <div class="myOuterContainer">
    <div class="d-flex justify-content-start optionNavBar">
      <ul class="nav nav-pills mb-3 " id="pills-tab" role="tablist">
        <li class="nav-item">
          <a class="nav-link" id="invoiceDisList-tab" data-toggle="pill" href="#invoiceDisList" role="tab"
            aria-controls="invoiceDisList" (click)="discountTypeListTab(); btn=false;" aria-selected="true">List</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="invoiceDisNew-tab" data-toggle="pill" href="#invoiceDisNew" role="tab"
            aria-controls="invoiceDisNew" (click)="discountTypeNewTab();" aria-selected="false">New</a>
        </li>
      </ul>
      <button type="button" class="btn btn-primary header-btn" *ngIf="btn" (click)="save()">
        Save
      </button>
      <!-- <button type="button" class="btn btn-primary header-btn" *ngIf="btn" [disabled]="saveData.syskey==''"
        (click)="goDelete()">
        Delete
      </button> -->
    </div>
    <div id="invoiceDisList" style="margin-left: 2px; margin-right: 2px;">
      <div class="card mb-1" style=" width: 100%;">
        <div class="card-header bg-transparent advance-form" style="width: 100%;">
          {{spinner? 'Loading order list':'Advance'}}
          <i *ngIf="!spinner" (click)="advanceSearch(searchtab? false: true);"
            [class]="searchtab? 'fa fa-chevron-circle-up':'fa fa-chevron-circle-down'" aria-hidden="true">
          </i>
          <div class="spinner-border text-primary" role="status" id="spinner-advsearch" *ngIf="spinner">
            <span class="sr-only"></span>
          </div>
        </div>
        <div class="card-body" *ngIf="searchtab" id="advance-card-disType">
          <div class="row">
            <div class="col">
              <div class="form-group row">
                <label for="fDate" class="col-sm-5 col-form-label col-form-label-sm">From Date</label>
                <div class="col-sm">
                  <div class="input-group input-group-sm">
                    <input required [(ngModel)]="criteria.fromDate" class="form-control" matInput
                      [matDatepicker]="pickers1" placeholder="Select Date" name="fDate" id="fDate"
                      (dblclick)="dblClickFunc1()" (dateChange)="dateChange1($event)" readonly>
                    <div class="input-group-append date-form" style="width: fit-content;">
                      <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="pickers1.open()"></i>
                      <mat-datepicker #pickers1 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                      </mat-datepicker>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group row">
                <label for="sDate" class="col-sm-5 col-form-label col-form-label-sm">Start Date</label>
                <div class="col-sm">
                  <div class="input-group input-group-sm">
                    <input required [(ngModel)]="criteria.startDate" class="form-control" matInput
                      [matDatepicker]="pickers5" placeholder="Select Date" name="sDate" id="sDate"
                      (dblclick)="dblClickFunc5()" (dateChange)="dateChange5($event)" readonly>
                    <div class="input-group-append date-form" style="width: fit-content;">
                      <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="pickers5.open()"></i>
                      <mat-datepicker #pickers5 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                      </mat-datepicker>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group row">
                <label for="invDisCode" class="col-sm-5 col-form-label col-form-label-sm">Discount Code</label>
                <div class="col-sm">
                  <input type="text" id="invDisCode" name="invDisCode" 
                    [(ngModel)]="criteria.discountCode" class="form-control form-control-sm" 
                    matInput [formControl]="disCodeSearch" [matAutocomplete]="auto1">
                  <mat-autocomplete #auto1="matAutocomplete">
                    <mat-option *ngFor="let disCode of disCodeList" [value]="disCode.t1" style="font-size: small;">
                      {{disCode.t1}}
                    </mat-option>
                  </mat-autocomplete>
                </div>
              </div>
              <div class="form-group row">
                <label for="criInv-disType" class="col-sm-5 col-form-label col-form-label-sm">
                  Discount Type
                </label>
                <div class="col-sm">
                  <select class="custom-select custom-select-sm" [(ngModel)]="criteria.disType" 
                    id="criInv-disType" (change)="criChange('criInv-disType')">
                      <option value="" selected>-</option>
                      <option [value]="1">Price</option>
                      <option [value]="2">Inkind</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="criInv-disItem" class="col-sm-5 col-form-label col-form-label-sm">
                  Discount Item
                </label>
                <div class="col-sm">
                  <input type="text" id="criInv-disItem" name="criInv-disItem" 
                    class="form-control form-control-sm" [(ngModel)]="criteria.disItem" 
                    matInput [matAutocomplete]="auto2" [formControl]="disItemSearch" 
                    (change)="criChange('criInv-disItem')">
                    <!-- [disabled]="criteria.disType != '2'"  -->
                  <mat-autocomplete #auto2="matAutocomplete">
                    <mat-option *ngFor="let disItem of disItemList" [value]="disItem.t2" style="font-size: small;">
                      {{disItem.t2}}
                    </mat-option>
                  </mat-autocomplete>
                </div>
              </div>
            </div>
            <div class="col">
              <!-- <div class="form-group row">
                <label for="disPercent" class="col-sm-5 col-form-label col-form-label-sm">Discount Percent</label>
                <div class="col-sm">
                  <input type="text" id="disPercent" name="disPercent" class="form-control form-control-sm" 
                    matInput [(ngModel)]="criteria.discountPercent" [formControl]="disPercentSearch" 
                    [matAutocomplete]="auto3">
                  <mat-autocomplete #auto3="matAutocomplete">
                    <mat-option *ngFor="let disPercent of disPercentList" [value]="disPercent.t2" 
                      style="font-size: small;">
                        {{disPercent.n2}}%
                    </mat-option>
                  </mat-autocomplete>
                </div>
              </div> -->
              <div class="form-group row">
                <label for="invToDate" class="col-sm-5 col-form-label col-form-label-sm">To Date</label>
                <div class="col-sm">
                  <div class="input-group input-group-sm">
                    <input required [(ngModel)]="criteria.toDate" class="form-control" matInput
                      [matDatepicker]="pickers2" placeholder="Select Date" name="invToDate" id="invToDate"
                      (dblclick)="dblClickFunc2()" (dateChange)="dateChange2($event)" readonly>
                    <div class="input-group-append date-form" style="width: fit-content;">
                      <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="pickers2.open()"></i>
                      <mat-datepicker #pickers2 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                      </mat-datepicker>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group row">
                <label for="eDate" class="col-sm-5 col-form-label col-form-label-sm">End Date</label>
                <div class="col-sm">
                  <div class="input-group input-group-sm">
                    <input required [(ngModel)]="criteria.endDate" class="form-control" matInput
                      [matDatepicker]="pickers6" placeholder="Select Date" name="eDate" id="eDate"
                      (dblclick)="dblClickFunc6()" (dateChange)="dateChange6($event)" readonly>
                    <div class="input-group-append date-form" style="width: fit-content;">
                      <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="pickers6.open()"></i>
                      <mat-datepicker #pickers6 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                      </mat-datepicker>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group row">
                <label for="invDisDesc" class="col-sm-5 col-form-label col-form-label-sm">
                  Discount Desc
                </label>
                <div class="col-sm">
                  <input type="text" id="invDisDesc" name="invDisDesc" 
                    class="form-control form-control-sm" [(ngModel)]="criteria.discountDesc" 
                    matInput [formControl]="disDescSearch" [matAutocomplete]="auto3">
                  <mat-autocomplete #auto3="matAutocomplete">
                    <mat-option *ngFor="let disDesc of disDescList" [value]="disDesc.t2" style="font-size: small;">
                      {{disDesc.t2}}
                    </mat-option>
                  </mat-autocomplete>
                </div>
              </div>
              <div class="form-group row">
                <label for="criInv-disAmt" class="col-sm-5 col-form-label col-form-label-sm">
                  Discount Amount
                </label>
                <div class="col-sm">
                  <input type="text" id="criInv-disAmt" name="criInv-disAmt" 
                    class="form-control form-control-sm" [(ngModel)]="criteria.disAmt"
                    [disabled]="criteria.disType != '1'">
                </div>
              </div>
              <div class="form-group row">
                <label for="criInv-disItemQty" class="col-sm-5 col-form-label col-form-label-sm">
                  Discount Item Qty
                </label>
                <div class="col-sm">
                  <input type="text" id="criInv-disItemQty" name="criInv-disItemQty" 
                    [(ngModel)]="criteria.disItemQty" class="form-control form-control-sm"
                    [disabled]="criteria.disType != '2'">
                </div>
              </div>
            </div>
            <div class="col">
              <div class="form-group row">
                <label for="criInv-brandOwner" class="col-sm-5 col-form-label col-form-label-sm">
                  Brand Owner
                </label>
                <div class="col-sm">
                  <input type="text" id="criInv-brandOwner" name="criInv-brandOwner" 
                    matInput [formControl]="brandOwnerSearch" [matAutocomplete]="auto4" 
                    class="form-control form-control-sm" [(ngModel)]="criteria.brandOwner">
                  <mat-autocomplete #auto4="matAutocomplete">
                    <mat-option *ngFor="let brandOwner of brandOwnerList1" [value]="brandOwner.t2" 
                      style="font-size: small;">
                        {{brandOwner.t2}}
                    </mat-option>
                  </mat-autocomplete>
                </div>
              </div>
              <div class="form-group row">
                <label for="invDisPercent" class="col-sm-5 col-form-label col-form-label-sm">Promo Amount</label>
                <div class="col-sm">
                  <input type="text" id="invDisPercent" name="invDisPercent" 
                    class="form-control form-control-sm" [(ngModel)]="criteria.discountPercent">
                  <!-- <select class="custom-select custom-select-sm" [(ngModel)]="criteria.discountPercent" id="invDisPercent">
                    <option value="" selected>-</option>
                    <option [value]="disPercent.n2" *ngFor="let disPercent of disPercentList">
                      {{disPercent.n2}}
                    </option>
                  </select> -->
                </div>
              </div>
              <div class="form-group row">
                <label for="criInv-operator" class="col-sm-5 col-form-label col-form-label-sm">Operator</label>
                <div class="col-sm">
                  <select class="custom-select custom-select-sm" [(ngModel)]="criteria.operator" 
                    id="criInv-operator">
                    <!-- [disabled]="criteria.promoAmt == ''" -->
                      <option value="" selected>-</option>
                      <option [value]="1">less than ( < )</option>
                      <option [value]="2">equal ( = )</option>
                      <option [value]="3">equal and greater than ( >= )</option>
                      <option [value]="4">greater than ( > )</option>
                      <option [value]="5">between( >= and <= )</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="invShopDesc" class="col-sm-5 col-form-label col-form-label-sm">Shop Desc</label>
                <div class="col-sm">
                  <input type="text" id="invShopDesc" name="invShopDesc" 
                    class="form-control form-control-sm" [(ngModel)]="criteria.shopDesc" 
                    matInput [formControl]="shopDescSearch" [matAutocomplete]="auto5">
                  <mat-autocomplete #auto5="matAutocomplete">
                    <mat-option *ngFor="let shopDesc of shopDescList" [value]="shopDesc.shopName"
                      style="font-size: small;">
                      {{shopDesc.shopName}}
                    </mat-option>
                  </mat-autocomplete>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="d-flex justify-content-start">
                <div class="btn-group" role="group" style="height: 35px;">
                  <button (click)="search(0, true)" type="button" class="btn btn-primary" [disabled]="spinner">
                    <i class="fa fa-search" aria-hidden="true"></i>
                  </button>
                  <button (click)="refresh()" type="button" class="btn btn-primary">
                    <i class="fa fa-refresh" aria-hidden="true"></i>
                  </button>
                </div>
                <div class="d-flex justify-content-start">
                  <div class="btn-group" style="height: 35px; margin-left: 10px;">
                    <button (click)="print()" type="button" class="btn btn-primary">
                      Export
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <pagination-controls (pageChange)="pageChanged($event)" ></pagination-controls>
      <div class="table-responsive text-nowrap mt-1 border" style="height: 380px;">
        <table class="table table-hover mx-0" style="font-size: 13px;">
          <thead class="thead-dark">
            <tr>
              <th>No</th>
              <!-- <th>Date</th> -->
              <th>Code</th>
              <th>Description</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let d of disTypeList | paginate: config; let i = index;">
              <td scope="row" (click)="detail($event, i)" *ngIf="d.invDisStatus == 1">
                <b>
                  {{i+1}}
                </b>
              </td>
              <td scope="row" *ngIf="d.invDisStatus == 0">
                <b>
                  {{i+1}}
                </b>
              </td>
              <!-- <td>{{d.invDisDate}}</td> -->
              <td (click)="detail($event, i)" *ngIf="d.invDisStatus == 1"> {{d.invDisCode}} </td>
                <td *ngIf="d.invDisStatus == 0">{{d.invDisCode}}</td>

              <td (click)="detail($event, i)" *ngIf="d.invDisStatus == 1">{{d.invDisDesc}}</td>
              <td *ngIf="d.invDisStatus == 0">{{d.invDisDesc}}</td>
              
              <td (click)="detail($event, i)" *ngIf="d.invDisStatus == 1">{{d.fromDate}}</td> 
                <td *ngIf="d.invDisStatus == 0">{{d.fromDate}}</td> 

              <td (click)="detail($event, i)" *ngIf="d.invDisStatus == 1"> {{d.toDate}}</td>
                <td *ngIf="d.invDisStatus == 0">{{d.toDate}}</td> 
             
              <!-- <td id="invStatusChangeEvent" style="width: 16% !important;">
                <div class="btn-group" role="group" aria-label="Basic example">
                  <button type="button" class="btn btn-success btn-sm mr-1" (click)="disTypeStatusChange($event, d)"
                    [disabled]="d.invDisStatus == 1">
                    Active
                  </button>
                  <button type="button" class="btn btn-danger btn-sm" (click)="disTypeStatusChange($event, d)"
                    style="background-color: red; border-color: red;" [disabled]="d.invDisStatus == 0">
                    Inactive
                  </button>
                </div>
              </td> -->
              <td class="d-flex flex-row">
                <div class="custom-control custom-switch" style="width: 50px;">
                  <input type="checkbox" class="custom-control-input" 
                    [id]="'active-switch-'+d.invDisSyskey"
                    [(ngModel)]="d.invDisStatus" (change)="disTypeStatusChange(d)">
                  <label class="custom-control-label" 
                    [for]="'active-switch-'+d.invDisSyskey" style="width: 0px;">
                  </label>
                </div>
                <span class="text-muted" style="margin-left: -20px; margin-top: 2px;font-size: smaller;">{{d.invDisStatus?'Active':'Inactive'}}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div id="invoiceDisNew" style="margin-left: 3px;">
      <div id="invDisInfoLists">
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <a class="nav-item nav-link active" id="invDisHdr-tab" data-toggle="tab" (click)="hdrListTab()" 
            role="tab" href="#invDisHdr"  aria-controls="invDisHdr" aria-selected="true">
              Header
          </a>
          <a class="nav-item nav-link" id="invDisDtlList-tab" data-toggle="tab" (click)="dtlListTab()" 
            role="tab" href="#invDisDtlList"  aria-controls="invDisDtlList" aria-selected="false">
              Detail List
          </a>
          <a class="nav-item nav-link" id="invDisShopJuncList-tab" data-toggle="tab" (click)="shopJuncTab()" 
            role="tab" href="#invDisShopJuncList" aria-controls="invDisShopJuncList" aria-selected="false">
              Customer Applicablity
          </a>
        </div>
      </div>
      <div class="tab-content" id="nav-tabContent" style="margin-top: 5px;">
        <div class="tab-pane fade show active" id="invDisHdr" role="tabpanel" aria-labelledby="invDisHdr-tab">
          <div class="card">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <div class="form-group row">
                    <label for="invSaveDisCode" class="col-sm-4 col-form-label col-form-label-sm">
                      Promotion ID
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invSaveDisCode" [(ngModel)]="saveData.t1" (focus)="focusFunction()"
                        class="form-control form-control-sm" [disabled]="dtlFlag == true">
                    </div>
                  </div>
                  <div class="form-group row">
                    <label for="invValidFD" class="col-sm-4 col-form-label col-form-label-sm">Start Date</label>
                    <div class="col-sm-8">
                      <div class="input-group input-group-sm">    <!--  style="width: 170px;" -->
                        <input required class="form-control" id="invValidFD" name="invValidFD" 
                          matInput [(ngModel)]="saveDataDates.fromDate" [matDatepicker]="pickers3" 
                          (dateChange)="dateChange3($event)" (dblclick)="dblClickFunc3()" 
                          placeholder="Select Date" readonly>
                        <div class="input-group-append">
                          <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="pickers3.open()"></i>
                          <mat-datepicker #pickers3 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                          </mat-datepicker>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="form-group row">
                    <label for="invSaveDisDesc" class="col-sm-4 col-form-label col-form-label-sm">Description</label>
                    <div class="col-sm-8">
                      <input type="text" id="invSaveDisDesc" [(ngModel)]="saveData.t2" class="form-control form-control-sm">
                    </div>
                  </div>
                  <div class="form-group row">
                    <label for="invValidTD" class="col-sm-4 col-form-label col-form-label-sm">End Date</label>
                    <div class="col-sm-8">
                      <div class="input-group input-group-sm">    <!--  style="width: 170px;" -->
                        <input required class="form-control" id="invValidTD" name="invValidTD" 
                          matInput [(ngModel)]="saveDataDates.toDate" [matDatepicker]="pickers4" 
                          (dateChange)="dateChange4($event)" (dblclick)="dblClickFunc4()" 
                          placeholder="Select Date" readonly>
                        <div class="input-group-append">
                          <i class="input-group-text fa fa-calendar" aria-hidden="true" (click)="pickers4.open()"></i>
                          <mat-datepicker #pickers4 displayFormat="DD/MM/YYYY" pickerFormat="DD/MM/YYYY">
                          </mat-datepicker>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade show active" id="invDisDtlList" role="tabpanel" aria-labelledby="invDisDtlList-tab">
          <div class="card">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <div class="form-group row">
                    <label for="invDiscountType" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Type
                    </label>
                    <div class="col-sm-8">
                      <select id="invDiscountType" [(ngModel)]="detailDataList.n3" 
                        class="custom-select custom-select-sm" (change)="disTypeChange()">
                          <option value="" selected>-</option>
                          <option [value]="1">Price</option>
                          <option [value]="2">Inkind</option>
                      </select>
                    </div>
                  </div>
                  <div class="form-group row" style="margin-left: 0px;">
                    <button type="button" class="btn btn-primary btn-sm" 
                      (click)="addGiftList(true, -1)" [disabled]="detailDataList.n3 != '2'">
                        Add Inkind Detail
                    </button>
                  </div>
                  <!-- <div class="form-group row">
                    <label for="invDiscountItemType" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Item Type
                    </label>
                    <div class="col-sm-8">
                      <select id="invDiscountItemType" [(ngModel)]="detailDataList.n8" 
                        class="custom-select custom-select-sm" (change)="disItemTypeChange()" 
                        [disabled]="detailDataList.n3 != '2'">
                          <option value="" selected>-</option>
                          <option [value]="1">Gift</option>
                          <option [value]="2">Coupon</option>
                      </select>
                    </div>
                  </div> -->
                </div>
                <div class="col">
                  <div class="form-group row">
                    <label for="invDiscountPriceType" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Price Type
                    </label>
                    <div class="col-sm-8">
                      <select id="invDiscountPriceType" class="custom-select custom-select-sm" 
                        [(ngModel)]="detailDataList.n4" [disabled]="detailDataList.n3 != '1'">
                          <option value="" selected>-</option>
                          <!-- <option [value]="1">Amount</option> -->
                          <option [value]="2">Percentage</option>
                      </select>
                    </div>
                  </div>
                  <!-- <div class="form-group row" id="invDiscountItem0">
                    <label for="invDiscountItem" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Item
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invDiscountItem" name="invDiscountItem" 
                        class="form-control form-control-sm" [disabled]="true">
                    </div>
                  </div>
                  <div class="form-group row" id="invDiscountItem1">
                    <label for="invDiscountItemGift" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Item
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invDiscountItemGift" name="invDiscountItemGift" 
                        class="form-control form-control-sm" matInput [matAutocomplete]="auto7" 
                        [formControl]="giftSearch" [(ngModel)]="detailDataList.t2" 
                        (keyup)="discountItemChange('gift')">
                      <mat-autocomplete #auto7="matAutocomplete">
                        <mat-option *ngFor="let discountItemGift of giftList; let i = index;" 
                          [value]="discountItemGift.t2" style="font-size: small;" 
                          (click)="discountItemChange('gift')">
                            {{discountItemGift.t2}}
                        </mat-option>
                      </mat-autocomplete>
                    </div>
                  </div>
                  <div class="form-group row" id="invDiscountItem2">
                    <label for="invDiscountItemCoupon" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Item
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invDiscountItemCoupon" name="invDiscountItemCoupon" 
                        class="form-control form-control-sm" matInput [matAutocomplete]="auto8" 
                        [formControl]="couponSearch" [(ngModel)]="detailDataList.t2" 
                        (keyup)="discountItemChange('coupon')">
                      <mat-autocomplete #auto8="matAutocomplete">
                        <mat-option *ngFor="let discountItemCoupon of couponList; let i = index;" 
                          [value]="discountItemCoupon.t1" style="font-size: small;" 
                          (click)="discountItemChange('coupon')">
                            {{discountItemCoupon.t1}}
                        </mat-option>
                      </mat-autocomplete>
                    </div>
                  </div> -->
                </div>
                <div class="col">
                  <div class="form-group row">
                    <label for="invAmtPercent" class="col-sm-4 col-form-label col-form-label-sm">
                      Price Discount Rate
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invAmtPercent" class="form-control form-control-sm" 
                        [(ngModel)]="detailDataList.n5" [disabled]="detailDataList.n3 != '1'"
                        (keypress)="validateDisPercent($event)">
                        <!-- (keyup)="decimalDisable($event)" -->
                    </div>
                  </div>
                  <!-- <div class="form-group row">
                    <label for="invDisItemQty" class="col-sm-4 col-form-label col-form-label-sm">
                      Dis Item Qty
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invDisItemQty" class="form-control form-control-sm" 
                        [(ngModel)]="detailDataList.n7" [disabled]="detailDataList.n6 == ''">
                    </div>
                  </div> -->
                  <!-- <div class="form-group row" style="float: right; margin-right: 5px;">
                    <button type="button" class="btn btn-primary" (click)="addDtlLine()">
                      {{updateIndex < 0? 'Add' : 'Update'}}
                    </button>
                    <button type="button" class="btn btn-primary" (click)="clear()" 
                      style="margin-left: 3px;">
                        Clear
                    </button>
                  </div> -->
                </div>
              </div>
              <hr/>
              <div class="row">
                <div class="col">
                  <div class="form-group row">
                    <label for="invOperator" class="col-sm-4 col-form-label col-form-label-sm">Operator</label>
                    <div class="col-sm-8">
                      <select id="invOperator" class="custom-select custom-select-sm" 
                        [(ngModel)]="detailDataList.n10">
                          <option value="" selected>-</option>
                          <option [value]="1">less than ( < )</option>
                          <option [value]="2">equal ( = )</option>
                          <option [value]="3">equal and greater than ( >= )</option>
                          <option [value]="4">greater than ( > )</option>
                          <option [value]="5">between( >= and <= )</option>
                      </select>
                    </div>
                  </div>
                  <div class="form-group row">
                    <label for="tempTsSearch" class="col-sm-4 col-form-label col-form-label-sm">
                      Brand Owner
                    </label>
                    <div class="col-sm-8">
                      <select id="invDiscountBOcb" class="custom-select custom-select-sm" 
                        (change)="boChange($event)">
                          <option value="" selected>-</option>
                          <option [value]="boList.syskey" 
                            *ngFor="let boList of brandOwnerList; let n = index;">
                              {{boList.t2}}
                          </option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="form-group row">
                    <label for="invSaveDisPercent" class="col-sm-4 col-form-label col-form-label-sm">
                      Revenue 1
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invSaveDisPercent" class="form-control form-control-sm" 
                        [(ngModel)]="detailDataList.n2" [disabled]="detailDataList.n10 == ''">
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="form-group row">
                    <label for="invSaveDisPercent2" class="col-sm-4 col-form-label col-form-label-sm">
                      Revenue 2
                    </label>
                    <div class="col-sm-8">
                      <input type="text" id="invSaveDisPercent2" class="form-control form-control-sm" 
                        [(ngModel)]="detailDataList.n9" [disabled]="detailDataList.n10 != '5'">
                    </div>
                  </div>
                  <div class="form-group row" style="float: right; margin-right: 5px;">
                    <button type="button" class="btn btn-primary" (click)="addDtlLine()">
                      {{updateIndex < 0? 'Add' : 'Update'}}
                    </button>
                    <button type="button" class="btn btn-primary" (click)="clear()" 
                      style="margin-left: 3px;">
                        Clear
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div>
            <table class="table table-hover table-striped" style="font-size: 13px;">
              <thead class="thead-dark">
                <tr>
                  <th>No</th>
                  <th>Brand Owner</th>
                  <th>Operator</th>
                  <th>Revenue 1</th>
                  <th>Revenue 2</th>
                  <th>Dis Type</th>
                  <th>Dis Price Type</th>
                  <th>Price Discount Rate</th>
                  <!-- <th>Dis Item Type</th>
                  <th>Dis Item</th>
                  <th>Item Qty</th> -->
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let sdDtl of saveData.invDisDetailList; let i = index;">
                  <td scope="row" (click)="updateDtlLine($event, i)">
                    <b>
                      {{i+1}}
                    </b>
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.t3}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n10 == '1'? 'less than' : 
                      (sdDtl.n10 == '2'? 'equal' : 
                        (sdDtl.n10 == '3'? 'equal and greater than' : 
                          (sdDtl.n10 == '4'? 'greater than' : 'between')))}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n2}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n9 == ''? '-' : sdDtl.n9}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n3 == '1'? 'Price' : 'Inkind'}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n4 == ''? '-' : (sdDtl.n4 == '1'? 'Amount' : 'Percent')}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n5 == ''? '-' : sdDtl.n5}}
                  </td>
                  <!-- <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n8 == ''? '-' : (sdDtl.n8 == '1'? 'Gift' : 'Coupon')}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.t2 == ''? '-' : sdDtl.t2}}
                  </td>
                  <td (click)="updateDtlLine($event, i)">
                    {{sdDtl.n7 == ''? '-' : sdDtl.n7}}
                  </td> -->
                  <td>

                    <div *ngIf="sdDtl.n3 == '2'" style="margin-bottom: 3px;">
                      <button type="button" (click)="addGiftList(false, i)" 
                        class="btn btn-primary btn-sm" [disabled]="updateIndex > -1">
                          View Inkind
                      </button>
                    </div>
                    <div *ngIf="sdDtl.syskey != ''; else btnDisable">
                      <div>
                        <button type="button" (click)="deleteDtlLine($event, i)" 
                          class="btn btn-primary btn-sm" *ngIf="sdDtl.recordStatus == 1"
                          [disabled]="updateIndex > -1">
                            Delete
                        </button>
                        <button type="button" (click)="deleteDtlLine($event, i)" 
                          class="btn btn-primary btn-sm" *ngIf="sdDtl.recordStatus == 4" 
                          style="background-color: grey; border-color: grey;"
                          [disabled]="updateIndex > -1">
                            Deleted
                        </button>
                      </div>
                    </div>
                    <ng-template #btnDisable>
                      <button type="button" class="btn btn-light btn-sm" 
                        (click)="deleteDtlLine($event, i)" [disabled]="updateIndex > -1">
                          Remove
                      </button>
                    </ng-template>

                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="tab-pane fade show active" id="invDisShopJuncList" role="tabpanel" aria-labelledby="invDisShopJuncList-tab">
          <div class="card-body pb-0">
            <div class="row row-cols-1 row-cols-sm-2">                
              <div class="col">
                <div class="form-group row">
                  <label for="fd" class="col-sm-3 col-form-label col-form-label-sm">Choose File </label>
                  <div class="col-sm">
                    <input type="file" id="filechose" class="custom-file-input form-control-sm" name="filechose" [ngModelOptions]="{standalone: true}"
                    [ngModel]="importload" #chosefile (click)="resetValue()" (change)="onUpload($event)" >
                   <label class="custom-file-label col-form-label-sm text-truncate"
                    matTooltip="chosefile.value == ''? 'Name': chosefile.value"
                    for="filechose">{{chosefile.value == ''? 'Name': chosefile.value}}</label>
                  </div>    
                  <ion-button (click)="appliedExcelShopData()" style="margin: 0px 0px 20px 10px; height: 33px; text-transform: none;"
                  [disabled]="tsLoadingFlag">Apply</ion-button>       
                </div>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-sm-6">
              <div class="row">
                <div class="card" style="width: 100%; height: 100%; margin-left: 12px;">
                  <div class="card-header">
                    Applied Shops
                    <span class="float-right" style="margin-bottom: -5px; margin-top: -5px;">
                      <div class="input-group input-group-sm" style="width: 150px;">
                        <input type="text" aria-describedby="inputGroup-sizing-sm" id="searchBoxAS"
                          placeholder="Search" (change)="searchAppliedShop($event)" 
                          class="form-control" aria-label="Sizing example input">
                      </div>
                    </span>
                  </div>
                  <pagination-controls (pageChange)="assignedShopListPageChanged($event)">
                  </pagination-controls>
                  <div class="overflow-auto table-responsive text-nowrap" style="height: 300px;">
                    <table class="table table-hover surveyortable" style="font-size: 13px;">
                      <thead class="thead-dark">
                        <tr>
                          <th>No</th>
                          <th>Shop Code</th>
                          <th>Shop Name</th>
                          <th>Address</th>
                          <!-- <th>Brand Owner Name</th> -->
                          <th>Delete</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let sList of tempShopList | paginate: config1; let i = index">
                          <td>{{i+1}}</td>
                          <td>{{sList.shopCode}}</td>
                          <td>{{sList.t1}}</td>
                          <td>{{sList.address}}</td>
                          <!-- <td>{{sList.t3}}</td> -->
                          <td>
                            <div *ngIf="sList.syskey != ''; else btnDisable">
                              <div>
                                <button type="button" class="btn btn-primary btn-sm btndelete"
                                  (click)="juncRecordStatusChange($event, sList)" *ngIf="sList.recordStatus == '1'">
                                    Delete
                                </button>
                                <button type="button" class="btn btn-primary btn-sm"
                                  (click)="juncRecordStatusChange($event, sList)" *ngIf="sList.recordStatus == '4'"
                                  style="background-color: grey; border-color: grey;">
                                    Deleted
                                </button>
                              </div>
                            </div>
                            <ng-template #btnDisable>
                              <button type="button" class="btn btn-light btn-sm" (click)="removeShop($event, i)">
                                Remove
                              </button>
                            </ng-template>
                          </td>
                          <td>
                            <div class="btn-group" role="group" >
                              <button type="button" class="btn btn-success btn-sm" 
                              (click)="disTypeJuncStatusChange($event, sList)" 
                              [disabled]="sList.n3 == 1 || sList.syskey == ''">
                                Active
                            </button>
                            <button type="button" class="btn btn-danger btn-sm" 
                              (click)="disTypeJuncStatusChange($event, sList)" 
                              [disabled]="sList.n3 == 0 || sList.syskey == ''">
                                Inactive
                            </button>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="row">
                <div class="card" style="width: 96%; margin-left: 10px;">
                  <div class="card-header">
                    Shops
                    <div class="spinner-border text-primary" role="status" id="spinner-advsearch321" 
                      *ngIf="tsLoadingFlag">
                        <span class="sr-only"></span>
                    </div>
                    <span class="float-right">
                      <div class="btn-group" style="margin-right: 10px;">
                        <button class="btn btn-primary btn-sm" type="button" (click)="addShop()">
                          Add Shop
                        </button>
                      </div>
                      <i (click)="dropdown? dropdown=false: dropdown=true"
                        [class]="dropdown? 'fa fa-chevron-circle-up':'fa fa-chevron-circle-down'" aria-hidden="true">
                      </i>
                    </span>
                  </div>
                  <div class="card-body px-5 border-bottom" id="shopAdvanceForm" *ngIf="dropdown">
                    <div class="form-group row">
                      <label for="tempShopSearch" class="col-sm-4 col-form-label col-form-label-sm">Shop</label>
                      <div class="col-sm-8">
                        <input type="text" id="tempShopSearch" class="form-control form-control-sm"
                          [(ngModel)]="tempSearch.shopDesc">
                      </div>
                    </div>
                    <div class="form-group row">
                      <label for="tempTsSearch" class="col-sm-4 col-form-label col-form-label-sm">Township</label>
                      <div class="col-sm-8">
                        <input type="text" id="tempTsSearch" class="form-control form-control-sm"
                          [(ngModel)]="tempSearch.townDesc">
                      </div>
                    </div>
                    <div class="d-flex justify-content-end">
                      <div class="btn-group" role="group">
                        <button (click)="searchTownship()" type="button" class="btn btn-primary btn-sm">
                          Search
                        </button>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="card-body row">
                    <div class="col col-sm-8">
                      <div class="form-group row">
                        <label for="tempTsSearch" class="col-sm-4 col-form-label col-form-label-sm">
                          Brand Owner
                        </label>
                        <div class="col-sm-8">
                          <select id="invDiscountBOcb" (change)="boChange($event)" 
                            class="custom-select custom-select-sm">
                              <option value="" selected>-</option>
                              <option [value]="boList.syskey" *ngFor="let boList of brandOwnerList; let n = index;">
                                  {{boList.t2}}
                              </option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="col col-sm-4">
                      <button class="btn btn-sm btn-primary mr-2" (click)="addShop()">
                        Add Shop
                      </button>
                    </div>
                  </div> -->
                  <div class="overflow-auto" style="height: 300px;">
                    <mat-accordion>
                      <mat-expansion-panel *ngFor="let tsList of townList; let i = index;"
                      (opened)="openPanel(tsList)" [expanded]="tsList.panelExpanded">
                        <mat-expansion-panel-header>
                          <mat-panel-title>
                            {{tsList.TownDesc}}
                          </mat-panel-title>
                        </mat-expansion-panel-header>
                            
                        <div>
                          <input type="checkbox" id="{{tsList.TownSyskey}}" (change)="selectTown($event, tsList.TownSyskey)">
                          Select All
                        </div>

                        <pagination-controls [id]="tsList.shopListConfig.id" (pageChange)="shopListPageChanged($event, tsList)">
                        </pagination-controls>
                        <div class="overflow-auto table-responsive text-nowrap">
                          <table class="table table-hover surveyortable" style="font-size: 13px;">
                            <thead class="thead-dark">
                              <tr>
                                <th>No</th>
                                <th>Shop Code</th>
                                <th>Shop Name</th>
                                <th>Address</th>
                                <th>
                                  <!-- Select All
                                  <input type="checkbox" id="combo1{{i}}" (change)="selectTown($event, i)"> -->
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let shopList of tsList.ShopDataList | paginate: tsList.shopListConfig; let j = index;">
                                <td>{{j+1}}</td>
                                <td>{{shopList.shopCode}}</td>
                                <td>{{shopList.shopName}}</td>
                                <td>{{shopList.address}}</td>
                                <td>
                                  <!-- <button class="btn btn-sm" type="button" (click)="addShop($event, i, j)">
                                        <i class="fa fa-plus" aria-hidden="true"></i>
                                      </button> -->
                                  <!-- <input type="checkbox" id="cb1{{i}}and{{j}}" (change)="selectShop($event, i, j)"> -->
                                  <input type="checkbox" id="{{shopList.shopSysKey}}" [(ngModel)]="shopList.checkFlag" 
                                    (change)="selectShop($event, tsList, shopList, false)">
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </mat-expansion-panel>
                    </mat-accordion>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ion-content>
<div id="addInkindDetailInv" class="modal fade" tabindex="-1" role="dialog" 
  aria-labelledby="skuaddmodal1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header px-3 py-2">
          <h5 class="modal-title" id="inkindDetailTitleInv">
            Add Inkind Detail
          </h5>
        </div>
        <div class="modal-body overflow-auto py-0" style="height: 450px;">
          <app-invoice-discount-inkind-popup (outputInkindList)="modifyGetGiftList($event)" 
            [inputInkindList]="getGiftDataList" [isInkindEdit]="inkindEditFlag">
          </app-invoice-discount-inkind-popup>
        </div>
      </div>
    </div>
</div>